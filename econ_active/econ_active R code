library(ggplot2)
library(tidyr)
library(RColorBrewer)
library(ggsci)
setwd("E:/Downloads/R")

# load econ_active
econ_active <- read.csv("econ_active.csv")
colnames(econ_active)[colnames(econ_active) == "誰..Month"] <- "Month" #change colname
econ_active
# commit x-bar to prevent alphabetical reordering
econ_active$Month <- factor(econ_active$Month, levels = econ_active$Month)
# econ_active plot
econ_active %>%
  gather("Gender", "Population", -Month) %>%
  ggplot(aes(x= Month, y = Population, fill = Gender)) +
  geom_bar(position = "dodge", stat = "identity") +
  theme_minimal() +
  labs(title = "Economically Active Population By Gender | Korea 2020 - 2021", 
       x = "Month", y = "Population (thousands)") + 
  theme(plot.title = element_text(face = "bold"),
        axis.title.x = element_text(face = "bold"),
        axis.title.y = element_text(face = "bold"),
        legend.title = element_text(face = "bold")
  ) +
  scale_fill_aaas()  + 
  scale_y_continuous(limits = c(0, 30000), breaks=seq(0, 30000, 5000))

# employed csv
employed <- read.csv("Employed.csv")
colnames(employed)[colnames(employed) == "誰..Month"] <- "Month" #change colname
employed
# commit x-bar to prevent alphabetical reordering
employed$Month <- factor(employed$Month, levels = employed$Month)
# econ_active plot
employed %>%
  gather("Gender", "Population", -Month) %>%
  ggplot(aes(x= Month, y = Population, fill = Gender)) +
  geom_bar(position = "dodge", stat = "identity") +
  theme_minimal() +
  labs(title = "Employed Population By Gender | Korea 2020 - 2021", 
       x = "Month", y = "Population (thousands)") + 
  theme(plot.title = element_text(face = "bold"),
        axis.title.x = element_text(face = "bold"),
        axis.title.y = element_text(face = "bold"),
        legend.title = element_text(face = "bold")
  ) +
  scale_fill_aaas()  + 
  scale_y_continuous(limits = c(0, 30000), breaks=seq(0, 30000, 5000))

# unemployed csv
unemployed <- read.csv("Unemployed.csv")
colnames(unemployed)[colnames(unemployed) == "誰..Month"] <- "Month" #change colname
unemployed
# commit x-bar to prevent alphabetical reordering
unemployed$Month <- factor(unemployed$Month, levels = unemployed$Month)
# econ_active plot
unemployed %>%
  gather("Gender", "Population", -Month) %>%
  ggplot(aes(x= Month, y = Population, fill = Gender)) +
  geom_bar(position = "dodge", stat = "identity") +
  theme_minimal() +
  labs(title = "Unemployed Population By Gender | Korea 2020 - 2021", 
       x = "Month", y = "Population (thousands)") + 
  theme(plot.title = element_text(face = "bold"),
        axis.title.x = element_text(face = "bold"),
        axis.title.y = element_text(face = "bold"),
        legend.title = element_text(face = "bold")
  ) + 
  scale_fill_aaas()  + 
  scale_y_continuous(limits = c(0, 1600), breaks=seq(0, 1600, 100))

# perc participation csv
participation <- read.csv("perc_participation.csv")
colnames(participation)[colnames(participation) == "誰..Month"] <- "Month" #change colname
participation
# commit x-bar to prevent alphabetical reordering
participation$Month <- factor(participation$Month, levels = participation$Month)
# econ_active plot
participation %>%
  gather("Gender", "Population", -Month) %>%
  ggplot(aes(x= Month, y = Population, fill = Gender)) +
  geom_bar(position = "dodge", stat = "identity") +
  theme_minimal() +
  labs(title = "Percentage Workforce Participation By Gender | Korea 2020 - 2021", 
       x = "Month", y = "Population (thousands)") + 
  theme(plot.title = element_text(face = "bold"),
        axis.title.x = element_text(face = "bold"),
        axis.title.y = element_text(face = "bold"),
        legend.title = element_text(face = "bold")
  ) + 
  scale_fill_aaas()  + 
  coord_cartesian(ylim = c(45, 80)) +
  scale_y_continuous(breaks=seq(45, 80, 5))



